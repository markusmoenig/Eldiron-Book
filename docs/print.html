<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Eldiron Book (WiP)</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./mdbook-admonish.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Eldiron Creator</li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="projects.html"><strong aria-hidden="true">2.</strong> Project Layout</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="projects/assets.html"><strong aria-hidden="true">2.1.</strong> Assets Directory</a></li><li class="chapter-item expanded "><a href="projects/game.html"><strong aria-hidden="true">2.2.</strong> Game Directory</a></li></ol></li><li class="chapter-item expanded "><a href="nodegraph/nodegraph.html"><strong aria-hidden="true">3.</strong> Node Graphs & Scripting </a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodegraph/behavior_trees.html"><strong aria-hidden="true">3.1.</strong> Behavior Trees</a></li><li class="chapter-item expanded "><a href="nodegraph/control_flow.html"><strong aria-hidden="true">3.2.</strong> Control Flow</a></li><li class="chapter-item expanded "><a href="nodegraph/scripting.html"><strong aria-hidden="true">3.3.</strong> Scripting</a></li><li class="chapter-item expanded "><a href="nodegraph/mechanics.html"><strong aria-hidden="true">3.4.</strong> Mechanics</a></li><li class="chapter-item expanded "><a href="nodegraph/examples.html"><strong aria-hidden="true">3.5.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodegraph/examples/lookout.html"><strong aria-hidden="true">3.5.1.</strong> Lookout / Random Walk / Deal Damage</a></li><li class="chapter-item expanded "><a href="nodegraph/examples/onHit.html"><strong aria-hidden="true">3.5.2.</strong> Taking Damage: OnHit</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="ui_creator.html"><strong aria-hidden="true">4.</strong> User Interface</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="assets.html"><strong aria-hidden="true">4.1.</strong> Assets View</a></li><li class="chapter-item expanded "><a href="regions.html"><strong aria-hidden="true">4.2.</strong> Regions View</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="regions_drawing_tiles.html"><strong aria-hidden="true">4.2.1.</strong> Drawing Tiles</a></li><li class="chapter-item expanded "><a href="regions_edit_areas.html"><strong aria-hidden="true">4.2.2.</strong> Edit Areas</a></li><li class="chapter-item expanded "><a href="regions_characters.html"><strong aria-hidden="true">4.2.3.</strong> Characters</a></li><li class="chapter-item expanded "><a href="regions_settings.html"><strong aria-hidden="true">4.2.4.</strong> Settings</a></li></ol></li><li class="chapter-item expanded "><a href="characters.html"><strong aria-hidden="true">4.3.</strong> Characters View</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="characters_npc.html"><strong aria-hidden="true">4.3.1.</strong> NPCs</a></li><li class="chapter-item expanded "><a href="characters_player.html"><strong aria-hidden="true">4.3.2.</strong> Player</a></li></ol></li><li class="chapter-item expanded "><a href="systems.html"><strong aria-hidden="true">4.4.</strong> Systems View</a></li><li class="chapter-item expanded "><a href="items.html"><strong aria-hidden="true">4.5.</strong> Items View</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="item_state.html"><strong aria-hidden="true">4.5.1.</strong> State</a></li><li class="chapter-item expanded "><a href="item_settings.html"><strong aria-hidden="true">4.5.2.</strong> Settings</a></li></ol></li><li class="chapter-item expanded "><a href="game.html"><strong aria-hidden="true">4.6.</strong> Game View</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="game_settings.html"><strong aria-hidden="true">4.6.1.</strong> Settings</a></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Reference</li><li class="chapter-item expanded "><a href="scripting/scripting.html"><strong aria-hidden="true">5.</strong> Scripting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="scripting/character_scripts.html"><strong aria-hidden="true">5.1.</strong> Character Scripts</a></li><li class="chapter-item expanded "><a href="scripting/screen_scripts.html"><strong aria-hidden="true">5.2.</strong> Screen Scripts</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Nodes</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.1.</strong> Control Flow</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodes/behavior_tree.html"><strong aria-hidden="true">6.1.1.</strong> Behavior Tree</a></li><li class="chapter-item expanded "><a href="nodes/expression.html"><strong aria-hidden="true">6.1.2.</strong> Expression</a></li><li class="chapter-item expanded "><a href="nodes/has_target.html"><strong aria-hidden="true">6.1.3.</strong> Has Target ?</a></li><li class="chapter-item expanded "><a href="nodes/light.html"><strong aria-hidden="true">6.1.4.</strong> Linear</a></li><li class="chapter-item expanded "><a href="nodes/sequence.html"><strong aria-hidden="true">6.1.5.</strong> Sequence</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> Action</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodes/audio.html"><strong aria-hidden="true">6.2.1.</strong> Audio</a></li><li class="chapter-item expanded "><a href="nodes/call_behavior.html"><strong aria-hidden="true">6.2.2.</strong> Call Behavior</a></li><li class="chapter-item expanded "><a href="nodes/call_system.html"><strong aria-hidden="true">6.2.3.</strong> Call System</a></li><li class="chapter-item expanded "><a href="nodes/close_in.html"><strong aria-hidden="true">6.2.4.</strong> Close In</a></li><li class="chapter-item expanded "><a href="nodes/deal_damage.html"><strong aria-hidden="true">6.2.5.</strong> Deal Damage</a></li><li class="chapter-item expanded "><a href="nodes/drop_inventory.html"><strong aria-hidden="true">6.2.6.</strong> Drop Inventory</a></li><li class="chapter-item expanded "><a href="nodes/effect.html"><strong aria-hidden="true">6.2.7.</strong> Effect</a></li><li class="chapter-item expanded "><a href="nodes/heal.html"><strong aria-hidden="true">6.2.8.</strong> Heal</a></li><li class="chapter-item expanded "><a href="nodes/light.html"><strong aria-hidden="true">6.2.9.</strong> Light</a></li><li class="chapter-item expanded "><a href="nodes/lock_tree.html"><strong aria-hidden="true">6.2.10.</strong> Lock Tree</a></li><li class="chapter-item expanded "><a href="nodes/lookout.html"><strong aria-hidden="true">6.2.11.</strong> Lookout</a></li><li class="chapter-item expanded "><a href="nodes/message.html"><strong aria-hidden="true">6.2.12.</strong> Message</a></li><li class="chapter-item expanded "><a href="nodes/multi_choice.html"><strong aria-hidden="true">6.2.13.</strong> Multi Choice</a></li><li class="chapter-item expanded "><a href="nodes/pathfinder.html"><strong aria-hidden="true">6.2.14.</strong> Pathfinder</a></li><li class="chapter-item expanded "><a href="nodes/random_walk.html"><strong aria-hidden="true">6.2.15.</strong> Random Walk</a></li><li class="chapter-item expanded "><a href="nodes/respawn.html"><strong aria-hidden="true">6.2.16.</strong> Respawn</a></li><li class="chapter-item expanded "><a href="nodes/screen.html"><strong aria-hidden="true">6.2.17.</strong> Screen</a></li><li class="chapter-item expanded "><a href="nodes/script.html"><strong aria-hidden="true">6.2.18.</strong> Script</a></li><li class="chapter-item expanded "><a href="nodes/sell.html"><strong aria-hidden="true">6.2.19.</strong> Sell</a></li><li class="chapter-item expanded "><a href="nodes/set_state.html"><strong aria-hidden="true">6.2.20.</strong> Set State</a></li><li class="chapter-item expanded "><a href="nodes/set_tile.html"><strong aria-hidden="true">6.2.21.</strong> Set Tile</a></li><li class="chapter-item expanded "><a href="nodes/take_damage.html"><strong aria-hidden="true">6.2.22.</strong> Take Damage</a></li><li class="chapter-item expanded "><a href="nodes/take_heal.html"><strong aria-hidden="true">6.2.23.</strong> Take Heal</a></li><li class="chapter-item expanded "><a href="nodes/target.html"><strong aria-hidden="true">6.2.24.</strong> Target</a></li><li class="chapter-item expanded "><a href="nodes/teleport.html"><strong aria-hidden="true">6.2.25.</strong> Teleport</a></li><li class="chapter-item expanded "><a href="nodes/unlock_tree.html"><strong aria-hidden="true">6.2.26.</strong> Unlock Tree</a></li><li class="chapter-item expanded "><a href="nodes/untarget.html"><strong aria-hidden="true">6.2.27.</strong> Untarget</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.</strong> Area Specific</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodes/always.html"><strong aria-hidden="true">6.3.1.</strong> Always</a></li><li class="chapter-item expanded "><a href="nodes/action.html"><strong aria-hidden="true">6.3.2.</strong> Enter Area</a></li><li class="chapter-item expanded "><a href="nodes/inside_area.html"><strong aria-hidden="true">6.3.3.</strong> Inside Area</a></li><li class="chapter-item expanded "><a href="nodes/leave_area.html"><strong aria-hidden="true">6.3.4.</strong> Leave Area</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> Player Specific</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="nodes/action.html"><strong aria-hidden="true">6.4.1.</strong> Action</a></li><li class="chapter-item expanded "><a href="nodes/drop.html"><strong aria-hidden="true">6.4.2.</strong> Drop</a></li><li class="chapter-item expanded "><a href="nodes/move.html"><strong aria-hidden="true">6.4.3.</strong> Move</a></li><li class="chapter-item expanded "><a href="nodes/take.html"><strong aria-hidden="true">6.4.4.</strong> Take</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Eldiron Book (WiP)</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p align="center">
  <img src="images/logo.png">
</p>
<h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><a href="https://eldiron.com">Eldiron</a> is a cross-platform creator for classic role-playing-games (RPGs). It's main aim is to create games similar to the RPGs of the 80's and 90's but with modern features as well as support for single and multi-player experiences.</p>
<p>Eldiron consists of <strong>Eldiron Creator</strong>, a desktop application available for macOS, Windows and Linux, and various clients (and a server) which will run the created games on nearly any device.</p>
<p>Eldiron v1.0 is under active development and scheduled for Q1 2023. V1 will be able to create games similar to Ultima 4 and 5 with 3D retro regions and dungeons scheduled for v1.5.</p>
<p>Later goals are support for more perspectives (like isometric) and much more.</p>
<p>Eldiron is open source (licensed under the MIT) and 100% free to use.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="installing-from-source"><a class="header" href="#installing-from-source">Installing from source</a></h2>
<p>Eldiron is written in Rust, to run it you have to install Rust and its package manager cargo. Please follow the instructions on this <a href="https://www.rust-lang.org/tools/install">page</a>.</p>
<p>After you successfully installed Rust, clone the <a href="https://github.com/markusmoenig/Eldiron">repository</a> (or download the source via a .zip file), open a terminal, navigate to the Eldiron directory and start Eldiron Creator with <code>cargo run --release</code>.</p>
<h2 id="steam"><a class="header" href="#steam">Steam</a></h2>
<p>Once Eldiron is in pre-release it will be available on its Steam page.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="projects"><a class="header" href="#projects">Projects</a></h1>
<p>Eldiron Creator stores it's game projects in the <em>Eldiron</em> directory in your desktops <em>Documents</em> directory. When first started Eldiron will ask for the name of your first game project (the default name is <em>New Game</em>) and create the project with the default starter content.</p>
<p>When Eldiron is not running, you can rename game folders to change the name of the game, delete or copy game folders.</p>
<p>The design goal for Eldiron projects was to make sharing of game content between games as easy as possible. Most game components are saved in individual files to allow sharing them with others. Each section of this book will mention where the corresponding game data is saved.</p>
<p>Game projects consists of two directories: <em>assets</em> and <em>game</em>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assets-directory"><a class="header" href="#assets-directory">Assets Directory</a></h1>
<p>The <em>assets</em> directory contains all static data of the game.</p>
<ul>
<li>
<p>The <strong>audio</strong> directory contains all audio assets of your game. Only WAV files are currently supported.</p>
</li>
<li>
<p>The <strong>fonts</strong> directory contains all fonts used by the game, to install new fonts just copy new fonts into this directory and on the next restart of Eldiron they will show up in the relevant font selectors.</p>
</li>
<li>
<p>The <strong>tilemaps</strong> directory contains all tile-maps. Tile-maps are PNG images which contain game tiles. Copy new images into this folder and they will show up in the <strong>Tiles</strong> view upon restart. Eldiron will create .json files for each tile-map which include the user defined meta data for the tiles.</p>
</li>
</ul>
<p>The name of each file represents the in-game name of the represented entity. For example you can just rename a character file to rename the character itself. Eldiron will perform the same action when asked to rename a character.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-directory"><a class="header" href="#game-directory">Game Directory</a></h1>
<p>The <em>game</em> directory contains all user created data for the game, such as regions (drawn via tiles in the region editor) or character behavior graphs.</p>
<p>Each folder name represents the type of game content it contains and matches the user interface sections in Eldiron and in this book (i.e. <em>regions</em>, <em>characters</em>, <em>systems</em> and <em>items</em>) with the game behavior located directly in the game directory.</p>
<p>You can share individual files with others, but there are some dependencies you have to be aware of:</p>
<ul>
<li>
<p><em>Region</em> files need the tile-maps used to draw the region in the <em>assets/tilemaps</em> directory.</p>
</li>
<li>
<p><em>Systems</em> behavior files may be dependent on variables defined in the <em>characters</em> which invoke them.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="node-graphs--scripting-in-eldiron"><a class="header" href="#node-graphs--scripting-in-eldiron">Node Graphs &amp; Scripting in Eldiron</a></h1>
<p><img src="nodegraph/../images/nodegraph.png" alt="NodeGraph" /></p>
<p>Node graphs in Eldiron are a mix between a behavior node system and scripting. Eldiron tries to combine the best of both worlds. The overall flow of execution is defined via nodes, while parameters of nodes are expressions or scripts which can be as complex as needed.</p>
<p>This has the advantage that you can easily visualize the overall flow of execution in a graph while adding details to behavior via node parameters which do not clutter up the node graph.</p>
<p>For example in the above screenshot the <em>Go Raiding</em> behavior tree executes the <em>Pathfinding</em> node which guides the character to a certain position or area in a region.</p>
<p>While the pathfinding is ongoing, i.e. the character did not reach its destination yet, the node connected to the terminal on the right side of the pathfinder node is executed. If the character successfully reached its destination the green OK terminal at the bottom of the pathfinding node is executed, if an error occured, for example the way to the destination is blocked for a longer period of time, the red ERROR terminal at the bottom of the pathfinding node is executed.</p>
<p>The <em>Speed Delay</em> property of the pathfinding node is a number value between 0 (no speed delay, which is a full move per game tick) and the number of game ticks to be skipped while the move is ongoing..</p>
<p>You could just set the expression to</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>2
<span class="boring">}
</span></code></pre></pre>
<p>for the speed delay.</p>
<p>Or as we do in the above screenshot you could set it to</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>1 + d2
<span class="boring">}
</span></code></pre></pre>
<p>which is 1 plus a dice throw of 2 (a random number of one or two) which gives a bit of a random speed, as this expression is evaluated for every movement the speed varies while the character is walking from tile to tile.</p>
<p>Or if things get more complex you could check if the character is on horseback or not or which usage role the current tile the characer is standing on has (for making the character walk slower in forests or hills).</p>
<p>To understand node graphs please read about <a href="nodegraph/./nodegraph_behavior_trees.html">behavior trees</a>, <a href="nodegraph/">control flow</a> and the scripting subsystem.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="behavior-trees"><a class="header" href="#behavior-trees">Behavior Trees</a></h1>
<p>Every node graph in Eldiron (except <a href="nodegraph/./regions_edit_areas.html">area nodes</a> which are a bit more simple) utilizes behavior trees to break up the overall behavior into smaller, easily understandable chunks (trees).</p>
<p>A behavior tree is just a node with several terminals at the bottom which get executed from left to right. You typically rename the behavior tree to indicate what behavior the tree is executing, for example <em>Go Raiding</em>, or <em>Talk</em> and <em>Combat</em>.</p>
<p>In a programming language behavior trees would be similar to functions.</p>
<p>Every behavior tree node has an <em>Execute</em> property which indicates when the tree is executed:</p>
<ul>
<li><strong>Always</strong>. The behavior tree is always executed if the graph is not locked.</li>
<li><strong>On Startup</strong>. The behavior tree is only executed once when the graph is created.</li>
<li><strong>On Demand</strong>. The behavior tree is executed on demand.</li>
</ul>
<p>Behavior trees perform the AI for non-player-characters (NPCs) and connect input commands from the <em>Player</em> character to the right player action (see the <a href="nodegraph/./characters.html">characters section</a>).</p>
<p>All behavior trees in a graph are listed as tabs at the top of the graph. Select the given behavior to edit it.</p>
<h2 id="active-vs-passive"><a class="header" href="#active-vs-passive">Active vs. Passive</a></h2>
<p>There are some behavior trees which have a passive behavior and need to end with an &quot; (P)&quot;. For example lets assume you have a healer character named Antony. When your player performs a custom action in a given direction Eldirons node system checks if the character (or item) located in the given direction has a behavior node tree called <em>&quot;ActionName (P)&quot;</em>. For example lets say the player looks towards Antony and you want to send a message to the player:</p>
<ul>
<li>Create a new behavior tree for Antony (by dragging a <a href="nodegraph/../nodes/behavior_tree.html">Behavior Tree</a>) node into the graph.</li>
<li>Rename the node to &quot;Look (P)&quot;</li>
<li>Attach a <a href="nodegraph/../nodes/message.html">Message</a> node to it with a status message like &quot;You see Antony, a famous healer.&quot;.</li>
</ul>
<p>Make sure that the behavior tree is set to execute &quot;On Demand&quot;.</p>
<p>One big difference between passive behavior trees and normal ones is that passive behavior trees use the context of the caller instead of their own. You do not want to send the message to Antony but to the player who is looking in his direction. Thats why the convention with the naming is important to mark this difference.</p>
<div id="admonition-tip" class="admonition tip">
<div class="admonition-title">
<p>Tip</p>
<p><a class="admonition-anchor-link" href="nodegraph/behavior_trees.html#admonition-tip"></a></p>
</div>
<div>
<p>The same <em>look</em> behavior is also possible with area nodes by utilizing the <a href="nodegraph/../nodes/action.html">Action</a> node. For example if you look at a sign and send want to send a message to the player. For more information about area nodes see <a href="nodegraph/../regions_edit_areas.html">the edit areas section</a>.</p>
</div>
</div>
<h2 id="behavior-trees-vs-system-trees"><a class="header" href="#behavior-trees-vs-system-trees">Behavior Trees vs System Trees</a></h2>
<p>Creating behavior trees for characters is fine. But if you want to implement general systems like crafting or magic you do not want to implement them again and again for every player character in the game. This is where system trees come into play. Go to the <a href="nodegraph/../systems.html">systems view</a> and create behavior trees for a given system like you would for characters. Now in your characters you can call these trees with the <a href="nodegraph/../nodes/call_system.html">Call System</a> node. They execute the same way as would your local trees with the same character context. This way you can create re-usable systems for your game.</p>
<div id="admonition-tip-1" class="admonition tip">
<div class="admonition-title">
<p>Tip</p>
<p><a class="admonition-anchor-link" href="nodegraph/behavior_trees.html#admonition-tip-1"></a></p>
</div>
<div>
<p>To create a new behavior tree just drag and drop a <em>Behavior Tree</em> node item into the node graph.</p>
</div>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="control-flow"><a class="header" href="#control-flow">Control Flow</a></h1>
<p>A behavior tree executes from top to bottom. It all starts with a behavior tree node. You can connect up to 5 nodes to the to its terminals at the bottom.</p>
<p>Nodes have input and output terminals. Terminals on the left and top are input terminals. Terminals on the right and bottom of the node are output terminals.</p>
<h4 id="in-progress"><a class="header" href="#in-progress">In Progress</a></h4>
<p>Nodes, like the <a href="nodegraph/./nodes/pathfinder.html">Pathfinder</a> node, use the terminal on the right to indicate an action in progress. The pathfinder node will execute the right terminal when the character did not reach it's destination yet.</p>
<h4 id="failure-and-success"><a class="header" href="#failure-and-success">Failure and Success</a></h4>
<p>Some nodes support red failure and green success terminals to indicate failure or success of the nodes function. The pathfinder node will execute the green success terminal if the character has reached its destination. The red failure terminal if the way to the destination is blocked for a longer period of time.</p>
<p>Another example is the <a href="nodegraph/./nodes/expression.html">Expression</a> node which executes failure or success depending on the evaluation of the boolean expression script (false or true).</p>
<h4 id="single-output-terminal-nodes"><a class="header" href="#single-output-terminal-nodes">Single Output Terminal Nodes</a></h4>
<p>Most nodes just support a single output terminal at the bottom when the node function cannot fail. For example sending a <a href="nodegraph/./nodes/message.html">Message</a> to the player.</p>
<div id="admonition-tip" class="admonition tip">
<div class="admonition-title">
<p>Tip</p>
<p><a class="admonition-anchor-link" href="nodegraph/control_flow.html#admonition-tip"></a></p>
</div>
<div>
<p>When you debug a game, the graph will visualize which node connections are being executed by coloring executed connections in orange.</p>
</div>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripting"><a class="header" href="#scripting">Scripting</a></h1>
<p>Every character (and optionally item) have their own script scopes, so you can create variables and control node flow via expressions.</p>
<p>Scripting is widely used inside Eldiron, as many node parameters are script or expressions. The <a href="nodegraph/../nodes/script.html">Script</a> node executes scripts and the <a href="nodegraph/../nodes/expression.html">Expression</a> node controls the node flow by either succeeding or failing depending on the boolean return value of the script expression.</p>
<p>Every character should have a startup tree which defines the variables of the character, for example</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let HP = 18 + d2; // 18 plus a dice throw of d2 (a value of 1 or 2)
let HP_MAX = HP;
let STR = 10;
let EXP = 0;
let LEVEL = 1;
...
<span class="boring">}
</span></code></pre></pre>
<p>The variables you define make up the attributes of your character. It is up to you if want to create a complex character system or just a minimal one. The example demo project which gets created for a new project is designed to get you started and is not too complex.</p>
<p>The same is true for monsters, you can make them very simple or very complex, the choice is yours. In the early RPGs monsters just had some HP and created random damage. But that was because computers were slow and having a few dozen orcs with fully worked out character systems would have been too slow. This limitation does not exist anymore today.</p>
<p>Apart from character attributes you can of course define as many helper variables as needed.</p>
<p>Note that the <code>d2</code> dice throw in the example script above is built into the scripting language, you can just use any <code>dx</code> value (where x is any number) to get a random value between 1 and x (inclusive).</p>
<p>In an <a href="nodegraph/../nodes/expression.html">expression</a> node you could check if your character has an experience value greater than 1000 with for example</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>EXP &gt; 1000
<span class="boring">}
</span></code></pre></pre>
<p>which would follow the green success terminal in the control flow if it is true or the red failure terminal if the character has less than 1000 experience points.</p>
<h2 id="special-variables"><a class="header" href="#special-variables">Special Variables</a></h2>
<p>The node system needs to know which variable name is used for your characters hit points as it needs to check if your character died or not or how much gold it has. These variable names are defined in the <a href="nodegraph/../game_settings.html">game settings</a>. When you change one of these special variable names, make sure to change them in all your scripts.</p>
<p>Another special variable is the <strong>alignment</strong> variable. It is set automatically by Eldiron based on your selection for the characters alignment in the character node graph. It is set to 1 for heroes, 0 for neutrals and -1 for monsters. You can of course also use your own more complex alignment system. The alignment is one of the variables often used in the <a href="nodegraph/../nodes/lookout.html">Lookout</a> node.</p>
<hr />
<p>For more information about scripting please see the <a href="nodegraph/../scripting.html">scripting reference</a>, especially the <a href="nodegraph/../scripting/character_scripts.html">character scripts</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mechanics"><a class="header" href="#mechanics">Mechanics</a></h1>
<p>While the behavior trees are very flexible, there are some fixed mechanics which are important to understand.</p>
<h2 id="dealing-and-taking-damage"><a class="header" href="#dealing-and-taking-damage">Dealing and Taking Damage</a></h2>
<p>Your character can deal damage via the <a href="nodegraph/../nodes/deal_damage.html">Deal Damage</a> node. The amount of damage dealt is returned by the numerical expression parameter <em>Damage</em> of the node. This expression can take any kind of bonuses of the character class or gear into account or just do a <code>d10</code> or similar if your character system is very simple.</p>
<p>However the deal damage node by itself does not do any damage, it will look up and execute the <strong>onHit</strong> behavior tree on the receiving character and execute it. This tree should contain a <a href="nodegraph/../nodes/take_damage.html">Take Damage</a> node which has an <em>Reduce By</em> parameter which calculates the amount to reduce the incoming damage. This expression can again any bonuses from the character class or gear into account to reduce the damage. After that the node applies the incoming damage (which was reduced by the calculated amount) and applies it to the hit point variable specified in the <a href="nodegraph/../game_settings.html">game settings</a> (<em>HP</em> by default).</p>
<p>If the character succeeds to take damage (i.e. does not die which means the hit points are greater than 0) it executes the green success terminal of the take damage node, if the hit points are 0 the red failure terminal is executed. See <em>Dying and Resurrection</em> below.</p>
<div id="admonition-warning" class="admonition warning">
<div class="admonition-title">
<p>Warning</p>
<p><a class="admonition-anchor-link" href="nodegraph/mechanics.html#admonition-warning"></a></p>
</div>
<div>
<p>If a character does not have a <code>onHit</code> tree or that tree does not have a take damage node, the character will never take damage!</p>
</div>
</div>
<h2 id="healing-and-taking-healing"><a class="header" href="#healing-and-taking-healing">Healing and Taking Healing</a></h2>
<p>The healing process is very similar to dealing damage. The <a href="nodegraph/../nodes/heal.html">Heal</a> node is used to specify the amount to heal, it than calls the <strong>onHeal</strong> tree on the receiving character which has to call the <a href="nodegraph/../nodes/take_heal.html">Take Heal</a> node to apply the healing.</p>
<p>Similar to the damage system, if a character has no <strong>onHeal</strong> tree or does not call the take heal node it will not be able to receive healing.</p>
<h2 id="dying-and-resurrection"><a class="header" href="#dying-and-resurrection">Dying and Resurrection</a></h2>
<p>If the <a href="nodegraph/../nodes/take_damage.html">Take Damage</a> node fails it means your character should do. You can set the state of the character via the <a href="nodegraph/../nodes/set_state.html">Set State</a> node. Purging the character means it will be deleted from the system. For a player character set it to Killed so that the character is not purged but can be resurrected later.</p>
<p>The example demo teleports the player to a healer who will resurrect him using the set state node. The healer uses the <a href="nodegraph/../nodes/lookout.html">Lookout</a> node to find character who can be resurrected. See <em>Targeting</em> below.</p>
<h2 id="targeting"><a class="header" href="#targeting">Targeting</a></h2>
<p>Players target other characters explicitly by performing some action in a given direction. But how do non player character target other characters ? The answer is the already mentioned <a href="nodegraph/../nodes/lookout.html">Lookout</a> node. This node searches all characters in the vicinity and checks if the character fits the expression. You can for example check its <em>alignment</em>. The node also allows checking the state of the character (<em>Normal</em> or <em>Killed</em>). For details please see the documentation of the <a href="nodegraph/../nodes/lookout.html">Lookout</a> node.</p>
<p>If the lookout node finds a fitting character, it will set that character as the target. That means that nodes which work on a target, like <a href="nodegraph/../nodes/close_in.html">Close In</a>, <a href="nodegraph/../nodes/deal_damage.html">Deal Damage</a> or <a href="nodegraph/../nodes/heal.html">Heal</a>, will target that character.</p>
<p>You can un-target using the <a href="nodegraph/../nodes/untarget.html">Untarget</a> node (for example if the target is too far away).</p>
<hr />
<p>Congratulations, you understood the most complex mechanics in Eldiron!</p>
<div style="break-before: page; page-break-before: always;"></div><p>Some examples which may be useful to understand specific workflows.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lookout--random-walk--deal-damage"><a class="header" href="#lookout--random-walk--deal-damage">Lookout / Random Walk / Deal Damage</a></h1>
<p><img src="nodegraph/examples/../../images/examples/Lookout.png" alt="Lookout" /></p>
<p>This example is for a monster which random walks the area and attacks a hero (if it finds one).</p>
<p>First, it checks <a href="nodegraph/examples/../../nodes/has_target.html">if it has a target</a> already.</p>
<p><em>If not</em></p>
<ul>
<li>Perform a <a href="nodegraph/examples/../../nodes/random_walk.html">Random Walk</a>.</li>
<li><a href="nodegraph/examples/../../nodes/lookout.html">Lookout</a> for a hero (alignment &gt; 0) to attack. In this example we do not use the return value as we check again if we have a target in the next game tick. Remember that the Lookout node automatically sets the target if it finds a fitting character.</li>
</ul>
<p><em>If yes</em></p>
<ul>
<li><a href="nodegraph/examples/../../nodes/untarget.html">Untarget</a> the target if the distance is too great (here a distance of 3 tiles)</li>
</ul>
<p>If un-target returns a failure, we still have a target (i.e. we did not un-target it):</p>
<ul>
<li><a href="nodegraph/examples/../../nodes/close_in.html">Close In</a> to the target, to a distance of one (melee weapon).</li>
</ul>
<p>If close in returns success, meaning we are next to the target</p>
<ul>
<li><a href="nodegraph/examples/../../nodes/deal_damage.html">Deal Damage</a> of <code>d3</code>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="taking-damage-onhit"><a class="header" href="#taking-damage-onhit">Taking Damage: onHit</a></h1>
<p><img src="nodegraph/examples/../../images/examples/onHit.png" alt="Lookout" /></p>
<p>This example is for a monster which takes damage and respawns if killed. Note that the <strong>onHit</strong> tree is called by the attackers <a href="nodegraph/examples/../../nodes/deal_damage.html">Deal Damage</a> node.</p>
<p>First, we execute the <a href="nodegraph/examples/../../nodes/take_damage.html">Take Damage</a> node, here we reduce the damage by a dice throw of d3.</p>
<p>If we take the damage successfully we play an effect animation on the character using the <a href="nodegraph/examples/../../nodes/effect.html">Effect</a> node.</p>
<p><em>If we do not take the damage successfully, we die</em></p>
<p>In this case</p>
<ul>
<li>
<p>Drop all our inventory as loot for the attacker using the <a href="nodegraph/examples/../../nodes/drop_inventory.html">Drop Inv.</a> node.</p>
</li>
<li>
<p>Set the state of the character to purged with the <a href="nodegraph/examples/../../nodes/set_state.html">Set State</a> node. This allows the system to re-allocate the memory used by this character.</p>
</li>
<li>
<p>Respawn the monster after some time using the <a href="nodegraph/examples/../../nodes/respawn.html">Respawn</a> node. Note that this node has no further outgoing terminals, it is the end of the line for this character instance.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-interface-of-eldiron-creator"><a class="header" href="#user-interface-of-eldiron-creator">User Interface of Eldiron Creator</a></h1>
<p>Eldiron Creator has two main toolbars.</p>
<h4 id="the-control-toolbar"><a class="header" href="#the-control-toolbar">The Control Toolbar</a></h4>
<p>The top one is called the control toolbar and has these functions:</p>
<ul>
<li><strong>Undo / Redo</strong>. The undo / redo state depends on the current view. Not all views have undo support.</li>
<li><strong>Project Switch</strong>. You can switch through your current game projects by clicking the <strong>&lt; &gt;</strong> arrows.</li>
<li><strong>Help</strong>. Opens this book on the currently displayed view section.</li>
<li><strong>Play</strong>. Plays the game.</li>
<li><strong>Debug</strong>. Debugs the game. This is mostly useful in the Region, Character and System views as you can visually see the node connections which are currently executed. Also you can monitor the variables in the Characters view as they always reflect the in-game state.</li>
</ul>
<h4 id="the-view-toolbar"><a class="header" href="#the-view-toolbar">The View Toolbar</a></h4>
<p>You can select the current view in the view toolbar (Assets, Regions, Characters, Systems, Items and Game). All views have two states, an overview state which shows all elements in an overview (activated by pressing the left part of the view button) and the detail state which shows an editor for the currently selected element (activated by pressing the right part of the button).</p>
<p>All views also have keyboard shortcuts between '1' to '7'.</p>
<p>To the left of the view buttons is also an element switch, you can use its <strong>&lt; &gt;</strong> buttons to switch through all available elements in the current view (or use the tab key to cycle through the currently visible elements).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assets-view-overview"><a class="header" href="#assets-view-overview">Assets View: Overview</a></h1>
<p>In the assets overview you can add to and edit the assets of your game.</p>
<p align="center">
  <img src="images/assets_overview.png">
</p>
<p>The assets overview displays a node for each asset present in the <a href="/projects/assets.html">assets</a> directory.</p>
<p>Assets currently are:</p>
<ul>
<li>
<p><strong>Audio</strong> files.</p>
</li>
<li>
<p><strong>Tile-maps</strong>. The icon displayed for the node is the tile set as default tile in the details view. You can set the <em>grid size</em> of the tile-map (the size of the square tiles in the tile-map) by clicking on the <em>Grid Size</em> property of the node.</p>
</li>
</ul>
<p>You can edit the details for a given asset by clicking the preview thumbnail of the asset node you want to edit.</p>
<h1 id="details-tile-maps"><a class="header" href="#details-tile-maps">Details: Tile-maps</a></h1>
<p align="center">
  <img src="images/assets_tilemap_detail.png">
</p>
<p>The tile-maps details view lets you assign meta-data for each tile in the tile-map. This is an important step as Eldiron needs to know how each tile is supposed to be used in-game.</p>
<p>You can click on a tile to select it (or multi-select tiles by clicking and dragging the mouse over a range of tiles).</p>
<p>The most important step is to give each tile a usage role, this can be one of:</p>
<ul>
<li><strong>Unused</strong> - This tile is ignored and will not be shown in the region editor.</li>
<li><strong>Environment</strong> - This is the default tile type for any kind of non blocking terrain. Use it for grass, floors etc.</li>
<li><strong>Road</strong> - Same as <em>Environment</em> but the AI in the <em>Pathfinder</em> node will prefer road tiles over environment tiles.</li>
<li><strong>Blocking</strong> - Every <em>Environment</em> tile which is not accessible to the player, like rocks, mountains, walls etc.</li>
<li><strong>Character</strong> - Character tiles, like animation tiles for a warrior.</li>
<li><strong>Utility</strong> - Utility character tiles. Like a ship or a horse.</li>
<li><strong>Water</strong> - Water tiles. Tiles where a ship can go.</li>
<li><strong>Effect</strong> - Effect tiles, like an explosion.</li>
<li><strong>Icon</strong> - In game icons for inventories etc (swords, armor etc.).</li>
<li><strong>UI Element</strong> - UI elements for screens and widgets.</li>
</ul>
<p>When you click the <strong>Enter Tags</strong> button you can assign command separated <em>tags</em> to a tile, like <em>cupboard</em> or <em>waterfall</em>. Tags are always lower case. Tags can be used to quickly find tiles or to auto-convert regions to different tile-maps (not yet implemented).</p>
<p>By clicking the <strong>Set Anim</strong> button you create an animation for the first tile in the selected range. The other tiles will be set to <em>Unused</em> by default.</p>
<p>The <strong>Clear Anim</strong> button will remove an animation sequence form the currently selected tile.</p>
<p>The <strong>Set Default</strong> button will set the currently selected tile as the default tile of the tile-map, it will be shown as the tile-map thumbnail in the overview.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="regions-view-overview"><a class="header" href="#regions-view-overview">Regions View: Overview</a></h1>
<p><img src="images/regions_overview.png" alt="Regions Overview" /></p>
<p>Regions in Eldiron can be towns, dungeons, the world itself, i.e. anywhere the characters can go. You can paint regions with the tiles you defined in the assets view. The behavior of tiles depends on the properties you set for the tiles in the <a href="./assets.html">tile-map details view</a>.</p>
<p>If you want to create a new region you can simply drag and drop the <em>Regions</em> item on the left into the overview. You can rename and delete regions using the context menu of each region node (located in the upper right of each node).</p>
<p>Opening the region details is as simple as clicking the preview thumbnail of the region node you want to edit.</p>
<h1 id="region-details-view"><a class="header" href="#region-details-view">Region Details View</a></h1>
<p>The details view has different modes which allow you to edit different aspects of a region:</p>
<ul>
<li><a href="./regions_drawing_tiles.html">Draw Tiles</a>. The drawing mode. Hotkey: 'D'.</li>
<li><a href="./regions_edit_areas.html">Edit Areas</a>. Define areas and edit their behavior. Hotkey: 'E'.</li>
<li><a href="./regions_characters.html">Characters</a>. Place character instances in the region. Hotkey: 'C'.</li>
<li><a href="./regions_settings.html">Settings</a>. Edit the settings of the region. Hotkey: 'S'.</li>
</ul>
<p>You can select the mode by clicking on the mode widget (which has a redish color) or by pressing the hotkey of a mode.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drawing-tiles"><a class="header" href="#drawing-tiles">Drawing Tiles</a></h1>
<p><img src="images/regions_draw_tiles.png" alt="Regions Draw Tiles" /></p>
<p>In the bottom of the view you have the tile selector. The tiles being shown depend on the currently selected valid usage role, which is one of <em>Environment</em>, <em>Road</em>, <em>Blocking</em>, <em>Water</em> and <em>UI Element</em>.</p>
<p>You can filter which tiles do show by:</p>
<ul>
<li>Cycling throw the tile-maps using the button at the top of the left sidebar (<em>All</em> shows the tiles of all tile-maps which is the default).</li>
<li>Entering a tag, for example <em>door</em>, would only show tiles with a <em>door</em> tag.</li>
</ul>
<p>While drawing you can select which layer to draw on, Eldiron supports 4 layers of transparency, with layer one having the lowest transparency level and four the highest.</p>
<p>The <strong>Remap</strong> buttons remaps all tiles in the region. This is necessary because the usage role of the tile is saved in the region itself. If you change the role of a tile in the <a href="./assets.html">assets view</a>, for example from an environment tile to a blocking tile, you need to remap the region to update the role of the tile.</p>
<p>While the the <strong>Clear</strong> button is checked Eldiron clears the clicked tile instead of drawing on it. The <strong>Pick</strong> button selects the tile at the currently clicked location so you can use it for drawing. The cleanr pick buttons of keyboard shortcuts of <em>C</em> and <em>P</em>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="edit-areas"><a class="header" href="#edit-areas">Edit Areas</a></h1>
<p><img src="images/regions_edit_areas.png" alt="Regions Draw Tiles" /></p>
<p>Areas are a group of tiles in a region which share common behavior. For example they may teleport the character entering it to a certain location, set a trap, open a door or send a message if you are near a sign. Apart from assigning behavior itself, areas can also be used from character nodes to go to a certain area or walk along a path defined by the area tiles. And lastly they can also modify the visual appearance of a tile, like for example emitting light.</p>
<p>You can cycle through the areas in your region by using the button next to the red <em>Edit Areas</em> button. Pressing the <em>Add Area</em> button will create an empty new area (that means no tiles are assigned to this area yet). You can <em>Delete</em> and <em>Rename</em> areas by pressing the respective button.</p>
<p>Clicking on a tile in the region will add the tile to the current area if the <em>Add Tile</em> mode is active, if it is set to <em>Remove</em> the tile will be removed from the area and if it is set to <em>Pick</em> it will select the area the clicked tile belongs to.</p>
<h2 id="behavior-nodes"><a class="header" href="#behavior-nodes">Behavior Nodes</a></h2>
<p>To add behavior to an area just drop nodes from the left sidebar into the graph below the region view. Area nodes work a bit different than other nodes in Eldiron. They do not utilize behavior trees but rather use nodes which query the current occupation state of an area, for example if the player (or another character) just entered or exited the area. These nodes have a green color. You can add multiple green nodes to an area and connect area behavior to them.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="characters"><a class="header" href="#characters">Characters</a></h1>
<p><img src="images/regions_characters.png" alt="Regions Draw Tiles" /></p>
<p>When in the character mode, clicking on a tile in the region will create an instance of the currently selected character at the tile. You can select the characters in the character view below the region.</p>
<p>Characters are added if <em>Add Instance</em> is active, if <em>Remove</em> is active the clicked instance of a character is removed.</p>
<p>Missing features for v1.0:</p>
<ul>
<li>Name character instances.</li>
<li>Optionally call a character script function on initialization (to set random character attributes or level).</li>
<li>Define which character instance is the debug instance which is shown in the character view.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="settings"><a class="header" href="#settings">Settings</a></h1>
<p><img src="images/regions_settings.png" alt="Regions Draw Tiles" /></p>
<p>In the settings you can tune many region specific settings.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The background color of the region
background = #000000
<span class="boring">}
</span></code></pre></pre>
<p>A hex color used as the background color of the region while drawing. Default is #000000, i.e. black.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Use &quot;tile&quot; for tile based movement or &quot;pixel&quot; for sub-tile movement.
movement = &quot;pixel&quot;
<span class="boring">}
</span></code></pre></pre>
<p>Defines the movement mode, tile based movements directly moves characters from one tile to the next, while pixel based movements create a smooth animation between tiles.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="characters-view-overview"><a class="header" href="#characters-view-overview">Characters View: Overview</a></h1>
<p><img src="images/characters_overview.png" alt="NodeGraph" /></p>
<p>The characters view allows you to define characters, or character templates for non-player-characters. It utilizes <a href="./nodegraph.html">nodegraphs</a> and <a href="./nodegraph_behavior_trees.html">behavior trees</a> to implement character AI. Please read these chapters first.</p>
<p>A special case is the <em>Player</em> character which does not implement AI but defines how input commands are mapped into behavior actions. The player character is always the first character in the overview and cannot be deleted.</p>
<p>To create a new character drag and drop the character item from the left sidebar into the overview. You can rename and delete characters via the nodes context menu. Click on the node thumbnail to open the characters detail view.</p>
<h1 id="characters-view-detail-view"><a class="header" href="#characters-view-detail-view">Characters View: Detail View</a></h1>
<p><img src="images/nodegraph.png" alt="NodeGraph" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="non-player-characters"><a class="header" href="#non-player-characters">Non-Player Characters</a></h1>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="characters_npc.html#admonition-note"></a></p>
</div>
<div>
<p>TBD</p>
</div>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="player-character"><a class="header" href="#player-character">Player Character</a></h1>
<p><img src="./images/characters_player.png" alt="Player" /></p>
<p>Player based characters map their behavior tree names to actions send from <a href="./ref_screen_scripts.html">screen scripts</a>. They basically define what todo for every user based action.</p>
<p>For some of these actions there are specific nodes available which handle the given action, like the <em>Move</em>, <em>Take</em> or <em>Drop</em> nodes. These nodes perform the action and return success or false, depending on the outcome.</p>
<p>The screenshot above shows an example for the <em>Move</em> command.</p>
<p>For all other actions please use the <em>Action</em> node, for example for <em>Look</em> or <em>Use</em>. The action node searches for a region, item or character with an behavior tree of the same name and execute that tree.</p>
<p>As the actions send from the screen scripts are user defined, you can easily map any action command to the behavior trees / actions of the same name, allowing a very easy and modular way to build up custom character behavior.</p>
<h2 id="special-message-shortcuts"><a class="header" href="#special-message-shortcuts">Special Message Shortcuts</a></h2>
<ul>
<li>
<p><strong>${DIRECTION}</strong> is the shortcut for the direction of the user initiated action. In the above screenshot we use it to send back &quot;Move ${Direction}&quot; or &quot;Move ${Direction} - Blocked&quot; messages back to the user.</p>
</li>
<li>
<p><strong>${SUBJECT}</strong> is the subject of the action. For take and drop actions it is the name of the item we take or drop. For example you can send something like this back to the user on success on the take action: &quot;You take: ${SUBJECT}.&quot;.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systems-view-overview"><a class="header" href="#systems-view-overview">Systems View: Overview</a></h1>
<p>Systems are <a href="./nodegraph.html">node graphs</a> which characters can invoke to perform certain kind of behavior, like combat or crafting or any other kind of action.</p>
<p>Systems make it possible to have a modular set of graphs which can be invoked at any time from any character. Internally they work the same as character graphs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="items-view-overview"><a class="header" href="#items-view-overview">Items View: Overview</a></h1>
<p><img src="./images/items_overview.png" alt="Items Overview" /></p>
<p>The items view allows you to create in-game items. Just drag and drop the <em>Item</em> from the list into the graph to create a new in-game item.</p>
<p>As always, click on the preview area to open the detail view.</p>
<h1 id="items-view-details"><a class="header" href="#items-view-details">Items View: Details</a></h1>
<p><img src="./images/items_detail_view.png" alt="Items Overview" /></p>
<p>The item details view adds behavior to your items utilizing <a href="./nodegraph.html">nodegraphs</a> and <a href="./nodegraph_behavior_trees.html">behavior trees</a>.</p>
<p>When a character performs an action on an item or a direction, let's say a <em>&quot;Look&quot;</em> action, the behavior tree of the same name in the item is executed. You can use this to send messages back to the user (&quot;You see a burning torch&quot;), ignite your torch using the <em>Light</em> node and execute more complex scripts if your item has <a href="./item_state.html">state</a>.</p>
<p>In the top left corner you have a permanent node which displays basic settings for the item: The default tile of the item and the <a href="./item_settings.html">item settings</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="item-state"><a class="header" href="#item-state">Item State</a></h1>
<p><img src="./images/items_state.png" alt="Item State" /></p>
<p>If you set the item state to true in the <a href="./item_settings.html">item setting</a> you can use scripts and expressions in your items as they have their own variable scopes.</p>
<p>In the above screenshot we have a Startup behavior tree which sets a &quot;is_burning&quot; boolean variable. This is the state of the torch, and we can use this state in the <em>&quot;Look&quot;</em> tree to send the appropriate message back to the user (&quot;You see a torch. Use it to ignite it.&quot; or &quot;You see a burning torch.&quot;). In the same way you can switch the state in the <em>&quot;Use&quot;</em> tree and adjust the tile for the item and it's light source settings.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="item-settings"><a class="header" href="#item-settings">Item Settings</a></h1>
<p>In the item settings you can define basic properties of your item.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Type of the item, either &quot;Weapon&quot;, &quot;Gear&quot; or &quot;Tool&quot;
item_type = &quot;Tool&quot;
<span class="boring">}
</span></code></pre></pre>
<p>The item typpe defines the role of the item, <em>&quot;Gear&quot;</em> and <em>&quot;Weapons&quot;</em> can be placed in the appropriate UI slots, everything else is a <em>&quot;Tool&quot;</em>.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// true if the item should have it's own state (variables).
state = true
<span class="boring">}
</span></code></pre></pre>
<p>If the item has state, it has it's own variable scope, see <a href="./item_state.html">item state</a>.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Value greater than 1 if item should be stackable. Only for items without state.
stackable = 1
<span class="boring">}
</span></code></pre></pre>
<p>Your item is stackable if this value is greater than 1. Stackable items cannot have a state and are meant for basic inventory for crafting.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// True if the item is static, i.e. cannot be picked up (campfire etc.).
static = true
<span class="boring">}
</span></code></pre></pre>
<p>If you set the item to static, it cannot be picked up by the user. Imagine a campfire for example. Static items are a great way to add interactivity to the environment. Note that static items and <a href="./regions_edit_areas.html">areas</a> have overlapping features. Using static items has the advantage that you can just simply instantiate items as many times as you like, whereas placing tiles and defining areas and behavior for them takes a bit more time and effort (but allows for more customized behavior).</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The sales price of the item. 0.0 if the item cannot be sold.
price = 0.0
<span class="boring">}
</span></code></pre></pre>
<p>The sales price of the item in your game currency (i.e. gold). This is a float value so that your game can optionally support a secondary currency in the fractional value of the float (like for example silver).</p>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="item_settings.html#admonition-note"></a></p>
</div>
<div>
<p>Eldiron does not currently support a secondary currency. This will be added in the future.</p>
</div>
</div>
<p>See also the currency properties in the <a href="./game_settings.html">game settings</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-view"><a class="header" href="#game-view">Game View</a></h1>
<p><img src="./images/game.png" alt="Game View" /></p>
<p>The game view graph handles the overall game logic, which, in an RPG, basically means what is the visible content of the game right now.</p>
<p>The game <a href="./nodegraph.html">nodegraph</a> works the same as other graphs by utilizing <a href="./nodegraph_behavior_trees.html">behavior trees</a>.</p>
<p>The visible content of the game is handled by screen nodes and their scripts.</p>
<p>The game view works differently than the other views in that it does not have a detail view, as there is only one game graph. Instead the detail button will show the <a href="./game_settings.html">game settings</a> which define global game properties.</p>
<p>Screen nodes and their screen scripts play an important role as they draw the content of your game as well as define user interaction. You can read more about screen scripts in the reference <a href="./ref_screen_scripts.html">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="game-settings"><a class="header" href="#game-settings">Game Settings</a></h1>
<p>The game settings define global poperties for your game. Here is a list of all supported properties.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The screen size of the game window.
screen_size = 1024, 608
<span class="boring">}
</span></code></pre></pre>
<p>This setting defines the size of your game window.</p>
<hr />
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The default square tile size when drawing game content.
square_tile_size = 32
<span class="boring">}
</span></code></pre></pre>
<p>The size of a square tile when drawing game content.</p>
<hr />
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The variable name of your primary currency. &quot;gold&quot; by default.
primary_currency = &quot;gold&quot;
// The variable name of your (optional) secondary currency. &quot;silver&quot; by default.
secondary_currency = &quot;silver&quot;
// How much secondary currency makes up one primary. 100 by default.
secondary_to_primary = 100
<span class="boring">}
</span></code></pre></pre>
<p>The variable name of your primary currency. You would assign currency to your character via a startup tree, like <code>rust let gold = 10;</code>. The <em>primary_currency</em> setting lets Eldiron know which variable in the character scope defines the primary currency.</p>
<hr />
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// The name of the characters hitpoints variable.
hitpoints = &quot;HP&quot;
// The name of the characters maximum hitpoints variable.
max_hitpoints = &quot;MAX_HP&quot;
<span class="boring">}
</span></code></pre></pre>
<p>The values define the name of your characters hitpoint and maximum hitpoints variables. The node system needs to know what script variables are used to calculate damage, when you character is dead or what is your current maximum hitpoint value when being healed. If you change these values in the settings make sure to change them in your scripts.</p>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="game_settings.html#admonition-note"></a></p>
</div>
<div>
<p>Secondary currencies are not yet supported. This will be added in the future.</p>
</div>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="scripting-1"><a class="header" href="#scripting-1">Scripting</a></h1>
<p>Scripting is an important building block for many tasks in Eldiron.</p>
<p>It provides the foundation of the node system and with screen scripts you define both the visible content of your game as well as the user interaction.</p>
<p>The scripting engine in Eldiron uses <a href="https://rhai.rs">Rhai</a>, a Rust based, easy-to-use yet powerful scripting language. Please see the <a href="https://rhai.rs/book/">Rhai Book</a> for furher information on Rhai and it's syntax.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="character-scripts"><a class="header" href="#character-scripts">Character Scripts</a></h1>
<p>Character scripts are script nodes or node expression parameters, many parameter of a node are expressions which either expect a boolean or numerical return value.</p>
<h3 id="startup-trees"><a class="header" href="#startup-trees">Startup Trees</a></h3>
<p>During startup you can define character attributes in your startup tree as discussed <a href="scripting/../nodegraph/scripting.html">here</a>.</p>
<h3 id="dice-throws"><a class="header" href="#dice-throws">Dice throws</a></h3>
<p>You can easily throw a dice and get a random value by using <code>dvalue</code>, like</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>d14
<span class="boring">}
</span></code></pre></pre>
<p>would return a random value between 1 and 14. This works with very number.</p>
<h3 id="handling-character-inventory"><a class="header" href="#handling-character-inventory">Handling character inventory</a></h3>
<p>Each character has an <em>inventory</em> class available available inside the script scope.</p>
<p>You can add inventory items to the character</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>inventory.add(&quot;Torch&quot;, 1);
<span class="boring">}
</span></code></pre></pre>
<p>where <code>Torch</code> is the inventory item and <code>1</code> the amount of items you want to add. The name of the item has to be name of an item created in the <a href="scripting/../items.html">items</a> view.</p>
<p>You can iterate your current inventory with</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>for item_index in 0..inventory.len() {
    let name = inventory.item_name_at(item_index);
    let amount = inventory.item_amount_at(item_index);
}
<span class="boring">}
</span></code></pre></pre>
<h4 id="gold"><a class="header" href="#gold">Gold</a></h4>
<p>The big exception to the inventory is gold. You can just assign gold to your character by creating a variable</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let gold = 10;
<span class="boring">}
</span></code></pre></pre>
<p>And of course you can freely modify the variable in your scripts.</p>
<p>The <a href="scripting/../nodes/sell.html">Sell</a> node autmatically sells and transfers items between buyers and sellers and also handles the money transfer.</p>
<p>The <a href="scripting/../nodes/drop_inventory.html">Drop Inv.</a> node drops all or some of your inventory items (mostly used on death).</p>
<p>When rendering gold in the game world the icon you specify in the Gold item specified in the item view is used.</p>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="scripting/character_scripts.html#admonition-note"></a></p>
</div>
<div>
<p>If you want to change the name of the gold variable to something else you have todo so in your <a href="scripting/../game_settings.html">game settings</a>.</p>
</div>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="screen-scripts"><a class="header" href="#screen-scripts">Screen Scripts</a></h1>
<p>Screen scripts define the visible content of your game as well as the player interaction. Screen scripts are part of screen nodes in the <a href="scripting/./game.html">game view</a>.</p>
<p>Screen scripts consists of several functions which will be called by Eldiron for various tasks:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>fn init() {
    // Initialize your screen script here. &quot;this&quot; is the global context.

    // this.width and this.height are set by default to the game settings screen_size.
    // Default is 1024 x 608.

    // this.tile_size is set to the game settings def_square_tile_size value.
    // Default is 32. Change it here for custom tile sizes.
    this.my_var = 5;
}

fn draw() {
    // Draw the content of the screen
}

fn key_down(key) {
    // Key press event
    if key == &quot;w&quot; {
        // Do something
    }
}

fn touch_down(x, y) {
    // The mouse has been pressed or a touch event occured at the specified coords.
}
<span class="boring">}
</span></code></pre></pre>
<p>The sub-chapters discuss all of Eldiron's script functions available to you in screen scripts.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="behavior-tree"><a class="header" href="#behavior-tree">Behavior Tree</a></h1>
<p>A behavior tree is a node with several terminals at the bottom which get executed from left to right. You typically rename the behavior tree to indicate what behavior the tree is executing, for example <em>Go Raiding</em>, or <em>Talk</em> and <em>Combat</em>.</p>
<p>In a programming language behavior trees would be similar to callable functions.</p>
<p>Every behavior tree node has an <em>Execute</em> property which indicates when the tree is executed:</p>
<ul>
<li><strong>Always</strong>. The behavior tree is always executed if the graph is not locked.</li>
<li><strong>On Startup</strong>. The behavior tree is only executed once when the graph is created.</li>
<li><strong>On Demand</strong>. The behavior tree is executed on demand.</li>
</ul>
<p>Behavior trees perform the AI for non-player-characters (NPCs) and connect input commands from the <em>Player</em> character to the right player action (see the <a href="nodes/./characters.html">characters section</a>).</p>
<p>All behavior trees in a graph are listed as tabs at the top of the graph. Select the given behavior to edit it.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="expression"><a class="header" href="#expression">Expression</a></h1>
<p>Executes the given script which is expected to return a boolean value.</p>
<h4 id="returns"><a class="header" href="#returns">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If the expression returns <code>true</code>.</li>
<li><strong>Failure</strong>. If the expression returns <code>false</code>.</li>
</ul>
<h3 id="see-also"><a class="header" href="#see-also">See also</a></h3>
<p><a href="nodes/../nodegraph/scripting.html">Scripting</a>, <a href="nodes/../scripting/scripting.html">Scripting Reference</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="has-target-"><a class="header" href="#has-target-">Has Target ?</a></h1>
<p>Intended for NPCs.</p>
<h4 id="returns-1"><a class="header" href="#returns-1">Returns</a></h4>
<p>Success if the character currently has a target, failure otherwise.</p>
<p><a href="nodes/../nodes/untarget.html">Untarget</a>, <a href="nodes/../nodes/lookout.html">Lookout</a>, <a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="light"><a class="header" href="#light">Light</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sequence"><a class="header" href="#sequence">Sequence</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="audio"><a class="header" href="#audio">Audio</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="call-behavior"><a class="header" href="#call-behavior">Call Behavior</a></h1>
<p>Executes the behavior tree of the given name.</p>
<h4 id="parameter"><a class="header" href="#parameter">Parameter</a></h4>
<ul>
<li><strong>System Name</strong>. The name of the system.</li>
<li><strong>Tree Name</strong>. The name of the behavior tree in the system to execute.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="call-system"><a class="header" href="#call-system">Call System</a></h1>
<p>Executes a behavior tree of the given system.</p>
<h4 id="parameter-1"><a class="header" href="#parameter-1">Parameter</a></h4>
<ul>
<li><strong>Tree Name</strong>. The name of the behavior tree to execute.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="close-in"><a class="header" href="#close-in">Close In</a></h1>
<p>Intended for NPCs.</p>
<p>Walks towards the current target.</p>
<h4 id="parameters"><a class="header" href="#parameters">Parameters</a></h4>
<ul>
<li><strong>To Distance</strong>. The desired distance to the target. This is most often the weapon range. For a melee weapon it would be 1.</li>
<li><strong>Speed Delay</strong>. A numerical expression indicating the walking speed. 0 is the fastest, no delay, the character will move one tile per game tick. Higher values will slow the character down. A value of 4 for example would mean that the character needs 4 game ticks to move to the next tile.</li>
</ul>
<h4 id="returns-2"><a class="header" href="#returns-2">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If we have reached the desired distance.</li>
<li><strong>Failure</strong>. We are not close enough yet.</li>
</ul>
<h4 id="see-also-1"><a class="header" href="#see-also-1">See also</a></h4>
<p><a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deal-damage"><a class="header" href="#deal-damage">Deal Damage</a></h1>
<p>Deals damage to the target.</p>
<p>This node does not deal damage by itself. It just calculates the damage to be dealt and than calls the <strong>onHit</strong> tree of the target, which should contain the <a href="nodes/take_damage.html">Take Damage</a> node, to reduce the damage based on the character attributes of the target.</p>
<h4 id="parameters-1"><a class="header" href="#parameters-1">Parameters</a></h4>
<ul>
<li><strong>Damage</strong>. This numerical expression defines the damage to deal. Like <code>2 + d3</code>. Query gear for bonuses (TBD).</li>
<li><strong>Speed Delay</strong>. A numerical expression indicating the delay. 0 means dealing damage for every game tick, 4 would mean a swing every 4 game ticks. Should be set to the weapon speed (TBD).</li>
</ul>
<h4 id="returns-3"><a class="header" href="#returns-3">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If we killed the target.</li>
<li><strong>Failure</strong>. The target is still alive.</li>
</ul>
<h4 id="see-also-2"><a class="header" href="#see-also-2">See also</a></h4>
<p><a href="nodes/../nodegraph/mechanics.html">Mechanics</a>, <a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop-inventory"><a class="header" href="#drop-inventory">Drop Inventory</a></h1>
<p>Drops all or some of your inventory, making it available for pick up by others. This can be used for example on death.</p>
<h3 id="parameters-2"><a class="header" href="#parameters-2">Parameters</a></h3>
<ul>
<li><strong>Drop</strong>. <em>Everything</em> will drop the complete inventory and all gold. Whereas <em>Random Item</em> will drop a random item and a random amount of gold.</li>
</ul>
<h3 id="see-also-3"><a class="header" href="#see-also-3">See also</a></h3>
<p><a href="nodes/../scripting/character_scripts.html">Character Scripts</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="effect"><a class="header" href="#effect">Effect</a></h1>
<p>Plays an effect on the character tile. Mostly used for visualizing taking damage or healing.</p>
<h4 id="parameters-3"><a class="header" href="#parameters-3">Parameters</a></h4>
<ul>
<li><strong>Effect</strong>. A tile animation marked as Effect.</li>
</ul>
<h3 id="see-also-4"><a class="header" href="#see-also-4">See also</a></h3>
<p><a href="nodes/../nodegraph/examples/onHit.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="heal"><a class="header" href="#heal">Heal</a></h1>
<p>Heals the current target.</p>
<p>This node does not heal by itself. It just calculates the amount of healing and than calls the <strong>onHeal</strong> tree of the target, which should contain the <a href="nodes/take_heal.html">Take Heal</a> node which applies the healing and to optionally increase the healing based on the attributes of the target character.</p>
<h4 id="parameters-4"><a class="header" href="#parameters-4">Parameters</a></h4>
<ul>
<li><strong>For</strong>. Either <em>Self</em> or <em>Target</em>.</li>
<li><strong>Amount</strong>. This numerical expression defines the amount of healing. Like <code>d10</code>.</li>
<li><strong>Speed Delay</strong>. A numerical expression indicating the delay. 0 means you can heal for every game tick, 4 would mean a possible heal every 4 game ticks.</li>
</ul>
<h4 id="returns-4"><a class="header" href="#returns-4">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If we healed the target.</li>
<li><strong>Failure</strong>. The healing failed.</li>
</ul>
<h4 id="see-also-5"><a class="header" href="#see-also-5">See also</a></h4>
<p><a href="nodes/../nodegraph/mechanics.html">Mechanics</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="light-1"><a class="header" href="#light-1">Light</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lock-tree"><a class="header" href="#lock-tree">Lock Tree</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lookout"><a class="header" href="#lookout">Lookout</a></h1>
<p>Intended for NPCs.</p>
<p>This node looks out for other characters to make it the target for an action. For example a monster may look for something to attack, a healer may look out for somebody to heal.</p>
<p>If the node successfully finds a character it will make the character the target, meaning that nodes which work on a target, like <a href="nodes/../nodes/close_in.html">Close In</a>, <a href="nodes/../nodes/deal_damage.html">Deal Damage</a> or <a href="nodes/../nodes/heal.html">Heal</a>, will target that character.</p>
<p>You can use <a href="nodes/../nodes/untarget.html">Untarget</a> to un-target it again.</p>
<h4 id="parameters-5"><a class="header" href="#parameters-5">Parameters</a></h4>
<ul>
<li><strong>State</strong>. You can select if the node looks out for a <em>Normal</em> (i.e. active / alive character) or a <em>Killed</em> one (for example to resurrect it).</li>
<li><strong>Expression</strong>. A numerical expression which checks the potential target character (i.e. this expression is run on the potential target!). For example a monster could check the alignment: <code>alignment &gt; 0</code>.</li>
<li><strong>Max Distance</strong>. The maximum distance to look out for characters.</li>
</ul>
<h4 id="returns-5"><a class="header" href="#returns-5">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If a fitting character has been found and is our new target.</li>
<li><strong>Failure</strong>. If no character has been found.</li>
</ul>
<h4 id="see-also-6"><a class="header" href="#see-also-6">See also</a></h4>
<p><a href="nodes/../nodes/untarget.html">Untarget</a>, <a href="nodes/../nodes/has_target.html">Has Target ?</a>, <a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="message-node"><a class="header" href="#message-node">Message Node</a></h1>
<p>This node sends a message to the player (or broadcasts a message from the player) and is probably one of the most used nodes.</p>
<p>There are several different message types:</p>
<ul>
<li><strong>Status</strong>. This send a message to the player from the system and is used for any kind of status updates.</li>
</ul>
<p>When sending messages there are several kind of codes you can use which the system replaces with the given text.</p>
<ul>
<li><code>${CONTEXT}</code>. The name of the current context, which can either be a character or an item name depending on the node context.</li>
<li><code>${DEF_CONTEXT}</code>. The name of the current context of the action prepended by an definite article if appropriate. The name will be in lowercase. For example <code>&quot;You take ${DEF_CONTEXT}&quot;</code> can become <em>&quot;You take the torch&quot;</em>.</li>
<li><code>${TARGET}</code>. The name of the current target of the character.</li>
<li><code>${DEF_TARGET}</code>. The name of the current target of the character prepended with by a definite article. The name will be in lowercase. For example <code>&quot;You kill ${DEF_TARGET}&quot;</code> can become <em>&quot;You kill the orc&quot;</em>.</li>
<li><code>${DAMAGE}</code>. If the character is currently dealing damage to the target or receiving damage, this code will be replaced with the amount of damage dealt or taken.</li>
<li><code>${HEALING}</code>. If the character is currently healing the target or receiving healing, this code will be replaced with the amount of healing.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="multi-choice"><a class="header" href="#multi-choice">Multi Choice</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pathfinder"><a class="header" href="#pathfinder">Pathfinder</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="random-walk"><a class="header" href="#random-walk">Random Walk</a></h1>
<p>Intended for NPCs.</p>
<p>This node randomly walks around the given position or area.</p>
<h4 id="parameters-6"><a class="header" href="#parameters-6">Parameters</a></h4>
<ul>
<li><strong>Max Distance</strong>. The maximum distance to walk from the starting position.</li>
<li><strong>Speed Delay</strong>. A numerical expression indicating the walking speed. 0 is the fastest, no delay, the character will move one tile per game tick. Higher values will slow the character down. A value of 4 for example would mean that the character needs 4 game ticks to move to the next tile.</li>
<li><strong>Delay</strong>. A numerical expression indicating the delay between movements, i.e. how many game ticks the character will wait on the same tile before moving randomly to the next one. 0 means no delay.</li>
</ul>
<h4 id="see-also-7"><a class="header" href="#see-also-7">See also</a></h4>
<p><a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="respawn"><a class="header" href="#respawn">Respawn</a></h1>
<p>Intended for NPCs.</p>
<p>Respawns the NPC after a given amount of game ticks. Should be applied only to characters which were previously purged via <a href="nodes/set_state.html">Set State</a>.</p>
<h3 id="parameters-7"><a class="header" href="#parameters-7">Parameters</a></h3>
<ul>
<li><strong>Ticks to Wait</strong>. The amount of game ticks to wait before respawning.</li>
</ul>
<h4 id="see-also-8"><a class="header" href="#see-also-8">See also</a></h4>
<p><a href="nodes/../nodegraph/mechanics.html">Mechanics</a>, <a href="nodes/../nodegraph/examples/onHit.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="screen"><a class="header" href="#screen">Screen</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="script"><a class="header" href="#script">Script</a></h1>
<p>Executes the given script.</p>
<h3 id="see-also-9"><a class="header" href="#see-also-9">See also</a></h3>
<p><a href="nodes/../nodegraph/scripting.html">Scripting</a>, <a href="nodes/../scripting/scripting.html">Scripting Reference</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sell"><a class="header" href="#sell">Sell</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-state"><a class="header" href="#set-state">Set State</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-tile"><a class="header" href="#set-tile">Set Tile</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="take-damage"><a class="header" href="#take-damage">Take Damage</a></h1>
<p>Take damage dealt by the <a href="nodes/deal_damage.html">Deal Damage</a> node.</p>
<p>This node calculates the reduction of the damage and applies it.</p>
<h4 id="parameters-8"><a class="header" href="#parameters-8">Parameters</a></h4>
<ul>
<li><strong>Reduce By</strong>. This numerical expression defines the reduction of the incoming damage. Should be based on gear (TBD).</li>
</ul>
<h4 id="returns-6"><a class="header" href="#returns-6">Returns</a></h4>
<ul>
<li><strong>Success</strong>. If the character survives the damage it took.</li>
<li><strong>Failure</strong>. The character died. You should now <a href="nodes/set_state.html">set the state</a> to Killed or Purged. See <a href="nodes/../nodegraph/mechanics.html">Mechanics</a>. You can <a href="nodes/respawn.html">Respawn</a> non-player characters too.</li>
</ul>
<h4 id="see-also-10"><a class="header" href="#see-also-10">See also</a></h4>
<p><a href="nodes/../nodegraph/mechanics.html">Mechanics</a>, <a href="nodes/../nodegraph/examples/onHit.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="take-heal"><a class="header" href="#take-heal">Take Heal</a></h1>
<p>Heal the amount defined by the <a href="nodes/heal.html">Heal</a> node.</p>
<p>This node calculates a potential healing increase and applies it to the hit points.</p>
<h4 id="parameters-9"><a class="header" href="#parameters-9">Parameters</a></h4>
<ul>
<li><strong>Increase By</strong>. This numerical expression define the increase of the healing based on character attributes.</li>
</ul>
<h4 id="returns-7"><a class="header" href="#returns-7">Returns</a></h4>
<ul>
<li><strong>Success</strong>. The character was successfuly healed for the given amount.</li>
<li><strong>Failure</strong>. Healing failed.</li>
</ul>
<h4 id="see-also-11"><a class="header" href="#see-also-11">See also</a></h4>
<p><a href="nodes/../nodegraph/mechanics.html">Mechanics</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="target"><a class="header" href="#target">Target</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="teleport"><a class="header" href="#teleport">Teleport</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unlock-tree"><a class="header" href="#unlock-tree">Unlock Tree</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="untarget"><a class="header" href="#untarget">Untarget</a></h1>
<p>Intended for NPCs.</p>
<p>This node un-targets the current target if the conditions are met.</p>
<p><em>Parameters</em></p>
<ul>
<li><strong>If Distance is Greater</strong>. Un-target the target if the distance to the current target is greater than the numerical expression. If you always want to un-target enter 0.</li>
</ul>
<p><em>Returns</em></p>
<ul>
<li><strong>Success</strong>. We successfully un-targeted the target.</li>
<li><strong>Failure</strong>. We did not un-target. We still have a target.</li>
</ul>
<p><em>See also</em></p>
<p><a href="nodes/../nodes/lookout.html">Lookout</a>, <a href="nodes/../nodes/has_target.html">Has Target ?</a>, <a href="nodes/../nodegraph/examples/lookout.html">Example</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="always"><a class="header" href="#always">Always</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="action"><a class="header" href="#action">Action</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inside-area"><a class="header" href="#inside-area">Inside Area</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="leave-area"><a class="header" href="#leave-area">Leave Area</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="action-1"><a class="header" href="#action-1">Action</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="drop"><a class="header" href="#drop">Drop</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="move"><a class="header" href="#move">Move</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="take"><a class="header" href="#take">Take</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
